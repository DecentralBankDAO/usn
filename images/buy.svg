<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="518px" preserveAspectRatio="none" style="width:487px;height:518px;background:#FFFFFF;" version="1.1" viewBox="0 0 487 518" width="487px" zoomAndPan="magnify"><defs><filter height="300%" id="f19yqk4eyo3kku" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="79" x="202.25" y="28.708">Buy USN</text><rect fill="#FFFFFF" filter="url(#f19yqk4eyo3kku)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="288.5" y="180.9141"/><rect fill="#FFFFFF" filter="url(#f19yqk4eyo3kku)" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="348" x="125.5" y="267.1797"/><rect fill="#FFFFFF" filter="url(#f19yqk4eyo3kku)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="280" x="125.5" y="411.7109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="29" x2="29" y1="75.25" y2="474.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="157.5" x2="157.5" y1="75.25" y2="474.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="293.5" x2="293.5" y1="75.25" y2="474.9766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="372.5" x2="372.5" y1="75.25" y2="474.9766"/><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="59.9482">alice</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="473.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="493.9717">alice</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="40" x="135.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="142.5" y="59.9482">usn</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="40" x="135.5" y="473.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="142.5" y="493.9717">usn</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="246.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="253.5" y="59.9482">priceoracle</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="246.5" y="473.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="253.5" y="493.9717">priceoracle</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="350.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="357.5" y="59.9482">bob</text><rect fill="#FEFECE" filter="url(#f19yqk4eyo3kku)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="350.5" y="473.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="357.5" y="493.9717">bob</text><rect fill="#FFFFFF" filter="url(#f19yqk4eyo3kku)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="288.5" y="180.9141"/><polygon fill="#A80036" points="145.5,147.7813,155.5,151.7813,145.5,155.7813,149.5,151.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="29.5" x2="151.5" y1="151.7813" y2="151.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="36.5" y="101.3169">send NEAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="36.5" y="116.4497">+ expected rate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="36.5" y="131.5825">+ slippage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="36.5" y="146.7153">+ transfer to</text><polygon fill="#A80036" points="276.5,176.9141,286.5,180.9141,276.5,184.9141,280.5,180.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="282.5" y1="180.9141" y2="180.9141"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="112" x="164.5" y="175.8481">get_price_data</text><polygon fill="#A80036" points="168.5,206.0469,158.5,210.0469,168.5,214.0469,164.5,210.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="162.5" x2="292.5" y1="210.0469" y2="210.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="174.5" y="204.981">NEAR/USDT rate</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="239.1797" y2="239.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="239.1797" y2="252.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="252.1797" y2="252.1797"/><polygon fill="#A80036" points="168.5,248.1797,158.5,252.1797,168.5,256.1797,164.5,252.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="164.5" y="234.1138">verify timestamp</text><path d="M125.5,267.1797 L189.5,267.1797 L189.5,274.1797 L179.5,284.1797 L125.5,284.1797 L125.5,267.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:2.0;" width="348" x="125.5" y="267.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="140.5" y="280.2466">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="264" x="204.5" y="279.3901">[if expected rate and slippage is passed]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="305.4453" y2="305.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="305.4453" y2="318.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="318.4453" y2="318.4453"/><polygon fill="#A80036" points="168.5,314.4453,158.5,318.4453,168.5,322.4453,164.5,318.4453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="164.5" y="300.3794">assert slippage</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="354.5781" y2="354.5781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="354.5781" y2="367.5781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="367.5781" y2="367.5781"/><polygon fill="#A80036" points="168.5,363.5781,158.5,367.5781,168.5,371.5781,164.5,367.5781" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="164.5" y="349.5122">mint USN</text><polygon fill="#A80036" points="40.5,392.7109,30.5,396.7109,40.5,400.7109,36.5,396.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="34.5" x2="156.5" y1="396.7109" y2="396.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="46.5" y="391.645">USN amount</text><path d="M125.5,411.7109 L189.5,411.7109 L189.5,418.7109 L179.5,428.7109 L125.5,428.7109 L125.5,411.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="280" x="125.5" y="411.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="140.5" y="424.7778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171" x="204.5" y="423.9214">[If "transfer to" is defined]</text><polygon fill="#A80036" points="361,445.9766,371,449.9766,361,453.9766,365,449.9766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157.5" x2="367" y1="449.9766" y2="449.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="164.5" y="444.9106">USN amount</text><!--MD5=[4f51b00e709a1facd062a3bfa0ed8378]
@startuml

title Buy USN

alice -> usn: send NEAR\n+ expected rate\n+ slippage\n+ transfer to

usn -> priceoracle: ""get_price_data""
activate priceoracle
usn <- priceoracle: NEAR/USDT rate
deactivate priceoracle
usn -> usn: verify timestamp

alt if expected rate and slippage is passed
usn -> usn: assert slippage
end

usn -> usn: mint USN

alice <- - usn: USN amount
alt If "transfer to" is defined
bob <- - usn: USN amount
end
@enduml

PlantUML version 1.2022.0(Tue Jan 11 18:16:42 EET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>